# Story 2.1: Receipt Photo Upload & Preview

## Status: Ready for Dev

## Story

As a user,
I want to upload a receipt photo from my device,
So that I can digitize my paper receipts.

## Acceptance Criteria

1. **AC1: Mobile Camera Integration** - User can upload from mobile camera (via file input capture)
2. **AC2: File System Select** - User can upload from desktop file system
3. **AC3: Format Support** - System accepts JPG, PNG, HEIC
4. **AC4: File Size Validation** - System validates image size (max 10MB)
5. **AC5: Upload Preview** - System displays preview of selected image before saving
6. **AC6: Progress Indicator** - Upload progress displays during file transfer

## Dev Notes

### Technical Context

#### File Handling
- **Input:** `<input type="file" accept="image/*" capture="environment">` for mobile camera support.
- **Validation:** Client-side check for `file.size` and `file.type`.
- **HEIC Support:** Browsers don't natively render HEIC. Need a conversion library (e.g., `heic2any`) for preview, or restrict to JPG/PNG if HEIC is too complex for MVP. *Decision: Attempt HEIC support or handle gracefully.*

#### Storage
- **Bucket:** Supabase Storage (Bucket: `receipts`).
- **Path:** `{userId}/{receiptId}.{ext}`.

### Tasks / Subtasks

- [ ] **Task 1: UI Component**
  - [ ] Create `ReceiptUpload` component
  - [ ] Implement drag-and-drop or click-to-select zone

- [ ] **Task 2: File Handling Logic**
  - [ ] Implement file selection handler
  - [ ] Add validation (Max 10MB, Allowed Types)
  - [ ] Generate ObjectURL for preview

- [ ] **Task 3: Upload Logic (Mock for now or Real?)**
  - [ ] *Note: Story 2.2 covers the Metadata form. This story focuses on the FILE UPLOAD process.*
  - [ ] Implement Supabase Storage upload function

## Success Criteria
✅ Camera opens on mobile
✅ File picker opens on desktop
✅ Large files rejected
✅ Preview shown immediately
